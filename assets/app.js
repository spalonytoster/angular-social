var app=angular.module("app",["ngRoute"]);angular.module("app").controller("ApplicationCtrl",["$scope","$http","UserSvc",function(o,e,t){o.$on("login",function(e,t){o.currentUser=t}),o.logout=function(){t.logout(),delete o.currentUser,delete window.localStorage.token},window.localStorage.token&&(console.log(window.localStorage.token),e.defaults.headers.common["X-auth"]=window.localStorage.token,t.getUser().success(function(e){console.log(e),o.currentUser=e}))}]),angular.module("app").controller("LoginCtrl",["$scope","UserSvc",function(o,e){o.login=function(t,n,r){console.log(r),e.login(t,n,r).then(function(e){o.$emit("login",e.data)})}}]),app.controller("PostsCtrl",["$scope","PostsSvc",function(o,e){o.addPost=function(){o.postBody&&e.create({body:o.postBody}).success(function(e){o.posts.unshift(e),o.postBody=null})},e.fetch().success(function(e){o.posts=e})}]),app.service("PostsSvc",["$http",function(o){this.fetch=function(){return o.get("/api/posts")},this.create=function(e){return o.post("/api/posts",e)}}]),angular.module("app").controller("RegisterCtrl",["$scope","UserSvc",function(o,e){o.register=function(o,t){e.createUser(o,t).then(function(o){201===o.status?console.log("registration successful"):console.log("registration unsuccessful")})}}]),angular.module("app").config(["$routeProvider","$locationProvider",function(o,e){e.html5Mode(!0),o.when("/",{controller:"PostsCtrl",templateUrl:"posts.html"}).when("/register",{controller:"RegisterCtrl",templateUrl:"register.html"}).when("/login",{controller:"LoginCtrl",templateUrl:"login.html"})}]),angular.module("app").service("UserSvc",["$http",function(o){var e=this;e.getUser=function(){return o.get("/api/users")},e.login=function(t,n,r){return o.post("/api/sessions",{username:t,password:n}).then(function(t){return r&&(console.log("rememberMe - userSvc"),window.localStorage.token=t.data,console.log("token from localStorage: "+window.localStorage.token)),o.defaults.headers.common["X-auth"]=t.data,e.getUser()})},e.logout=function(){delete o.defaults.headers.common["X-auth"]},e.createUser=function(e,t){return o.post("/api/users",{username:e,password:t})}}]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1vZHVsZS5qcyIsImFwcGxpY2F0aW9uLmN0cmwuanMiLCJsb2dpbi5jdHJsLmpzIiwicG9zdHMuY3RybC5qcyIsInBvc3RzLnN2Yy5qcyIsInJlZ2lzdGVyLmN0cmwuanMiLCJyb3V0ZXMuanMiLCJ1c2VyLnN2Yy5qcyJdLCJuYW1lcyI6WyJhcHAiLCJhbmd1bGFyIiwibW9kdWxlIiwiY29udHJvbGxlciIsIiRzY29wZSIsIiRodHRwIiwiVXNlclN2YyIsIiRvbiIsIl8iLCJ1c2VyIiwiY3VycmVudFVzZXIiLCJsb2dvdXQiLCJ3aW5kb3ciLCJsb2NhbFN0b3JhZ2UiLCJ0b2tlbiIsImNvbnNvbGUiLCJsb2ciLCJkZWZhdWx0cyIsImhlYWRlcnMiLCJjb21tb24iLCJnZXRVc2VyIiwic3VjY2VzcyIsInJlc3BvbnNlIiwibG9naW4iLCJ1c2VybmFtZSIsInBhc3N3b3JkIiwicmVtZW1iZXJNZSIsInRoZW4iLCIkZW1pdCIsImRhdGEiLCJQb3N0c1N2YyIsImFkZFBvc3QiLCJwb3N0Qm9keSIsImNyZWF0ZSIsImJvZHkiLCJwb3N0IiwicG9zdHMiLCJ1bnNoaWZ0IiwiZmV0Y2giLCJzZXJ2aWNlIiwidGhpcyIsImdldCIsInJlZ2lzdGVyIiwiY3JlYXRlVXNlciIsInN0YXR1cyIsImNvbmZpZyIsIiRyb3V0ZVByb3ZpZGVyIiwiJGxvY2F0aW9uUHJvdmlkZXIiLCJodG1sNU1vZGUiLCJ3aGVuIiwidGVtcGxhdGVVcmwiLCJzdmMiLCJ2YWwiXSwibWFwcGluZ3MiOiJBQUFBLEdBQUFBLEtBQUFDLFFBQUFDLE9BQUEsT0FDQSxXQ0RBRCxTQUFBQyxPQUFBLE9BQ0FDLFdBQUEsbUJBQUEsU0FBQSxRQUFBLFVBQUEsU0FBQUMsRUFBQUMsRUFBQUMsR0FDQUYsRUFBQUcsSUFBQSxRQUFBLFNBQUFDLEVBQUFDLEdBQ0FMLEVBQUFNLFlBQUFELElBRUFMLEVBQUFPLE9BQUEsV0FDQUwsRUFBQUssZUFDQVAsR0FBQU0sa0JBQ0FFLFFBQUFDLGFBQUFDLE9BR0FGLE9BQUFDLGFBQUFDLFFBQ0FDLFFBQUFDLElBQUFKLE9BQUFDLGFBQUFDLE9BQ0FULEVBQUFZLFNBQUFDLFFBQUFDLE9BQUEsVUFBQVAsT0FBQUMsYUFBQUMsTUFDQVIsRUFBQWMsVUFDQUMsUUFBQSxTQUFBQyxHQUNBUCxRQUFBQyxJQUFBTSxHQUNBbEIsRUFBQU0sWUFBQVksUUNqQkFyQixRQUFBQyxPQUFBLE9BQ0FDLFdBQUEsYUFBQSxTQUFBLFVBQUEsU0FBQUMsRUFBQUUsR0FDQUYsRUFBQW1CLE1BQUEsU0FBQUMsRUFBQUMsRUFBQUMsR0FDQVgsUUFBQUMsSUFBQVUsR0FDQXBCLEVBQUFpQixNQUFBQyxFQUFBQyxFQUFBQyxHQUNBQyxLQUFBLFNBQUFMLEdBQ0FsQixFQUFBd0IsTUFBQSxRQUFBTixFQUFBTyxZQ05BN0IsSUFBQUcsV0FBQSxhQUFBLFNBQUEsV0FBQSxTQUFBQyxFQUFBMEIsR0FDQTFCLEVBQUEyQixRQUFBLFdBQ0EzQixFQUFBNEIsVUFDQUYsRUFBQUcsUUFDQUMsS0FBQTlCLEVBQUE0QixXQUVBWCxRQUFBLFNBQUFjLEdBQ0EvQixFQUFBZ0MsTUFBQUMsUUFBQUYsR0FDQS9CLEVBQUE0QixTQUFBLFFBSUFGLEVBQUFRLFFBQUFqQixRQUFBLFNBQUFlLEdBQ0FoQyxFQUFBZ0MsTUFBQUEsT0NiQXBDLElBQUF1QyxRQUFBLFlBQUEsUUFBQSxTQUFBbEMsR0FDQW1DLEtBQUFGLE1BQUEsV0FDQSxNQUFBakMsR0FBQW9DLElBQUEsZUFFQUQsS0FBQVAsT0FBQSxTQUFBRSxHQUNBLE1BQUE5QixHQUFBOEIsS0FBQSxhQUFBQSxPQ0xBbEMsUUFBQUMsT0FBQSxPQUNBQyxXQUFBLGdCQUFBLFNBQUEsVUFBQSxTQUFBQyxFQUFBRSxHQUNBRixFQUFBc0MsU0FBQSxTQUFBbEIsRUFBQUMsR0FDQW5CLEVBQUFxQyxXQUFBbkIsRUFBQUMsR0FDQUUsS0FBQSxTQUFBTCxHQUNBLE1BQUFBLEVBQUFzQixPQUtBN0IsUUFBQUMsSUFBQSwyQkFHQUQsUUFBQUMsSUFBQSxtQ0NiQWYsUUFBQUMsT0FBQSxPQUNBMkMsUUFBQSxpQkFBQSxvQkFBQSxTQUFBQyxFQUFBQyxHQUNBQSxFQUFBQyxXQUFBLEdBQ0FGLEVBQ0FHLEtBQUEsS0FBQTlDLFdBQUEsWUFBQStDLFlBQUEsZUFDQUQsS0FBQSxhQUFBOUMsV0FBQSxlQUFBK0MsWUFBQSxrQkFDQUQsS0FBQSxVQUFBOUMsV0FBQSxZQUFBK0MsWUFBQSxrQkNOQWpELFFBQUFDLE9BQUEsT0FDQXFDLFFBQUEsV0FBQSxRQUFBLFNBQUFsQyxHQUNBLEdBQUE4QyxHQUFBWCxJQUVBVyxHQUFBL0IsUUFBQSxXQUNBLE1BQUFmLEdBQUFvQyxJQUFBLGVBRUFVLEVBQUE1QixNQUFBLFNBQUFDLEVBQUFDLEVBQUFDLEdBQ0EsTUFBQXJCLEdBQUE4QixLQUFBLGlCQUNBWCxTQUFBQSxFQUNBQyxTQUFBQSxJQUVBRSxLQUFBLFNBQUF5QixHQVFBLE1BUEExQixLQUNBWCxRQUFBQyxJQUFBLHdCQUNBSixPQUFBQyxhQUFBQyxNQUFBc0MsRUFBQXZCLEtBQ0FkLFFBQUFDLElBQUEsNEJBQUFKLE9BQUFDLGFBQUFDLFFBR0FULEVBQUFZLFNBQUFDLFFBQUFDLE9BQUEsVUFBQWlDLEVBQUF2QixLQUNBc0IsRUFBQS9CLGFBR0ErQixFQUFBeEMsT0FBQSxpQkFDQU4sR0FBQVksU0FBQUMsUUFBQUMsT0FBQSxXQUVBZ0MsRUFBQVIsV0FBQSxTQUFBbkIsRUFBQUMsR0FDQSxNQUFBcEIsR0FBQThCLEtBQUEsY0FDQVgsU0FBQUEsRUFDQUMsU0FBQUEiLCJmaWxlIjoiYXBwLmpzIiwic291cmNlc0NvbnRlbnQiOlsidmFyIGFwcCA9IGFuZ3VsYXIubW9kdWxlKCdhcHAnLCBbXHJcbiAgJ25nUm91dGUnXHJcbl0pO1xyXG4iLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcclxuLmNvbnRyb2xsZXIoJ0FwcGxpY2F0aW9uQ3RybCcsIGZ1bmN0aW9uICgkc2NvcGUsICRodHRwLCBVc2VyU3ZjKSB7XHJcbiAgJHNjb3BlLiRvbignbG9naW4nLCBmdW5jdGlvbiAoXywgdXNlcikge1xyXG4gICAgJHNjb3BlLmN1cnJlbnRVc2VyID0gdXNlcjtcclxuICB9KTtcclxuICAkc2NvcGUubG9nb3V0ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgVXNlclN2Yy5sb2dvdXQoKTtcclxuICAgIGRlbGV0ZSAkc2NvcGUuY3VycmVudFVzZXI7XHJcbiAgICBkZWxldGUgd2luZG93LmxvY2FsU3RvcmFnZS50b2tlbjtcclxuICB9O1xyXG5cclxuICBpZiAod2luZG93LmxvY2FsU3RvcmFnZS50b2tlbikge1xyXG4gICAgY29uc29sZS5sb2cod2luZG93LmxvY2FsU3RvcmFnZS50b2tlbik7XHJcbiAgICAkaHR0cC5kZWZhdWx0cy5oZWFkZXJzLmNvbW1vblsnWC1hdXRoJ10gPSB3aW5kb3cubG9jYWxTdG9yYWdlLnRva2VuO1xyXG4gICAgVXNlclN2Yy5nZXRVc2VyKClcclxuICAgIC5zdWNjZXNzKGZ1bmN0aW9uIChyZXNwb25zZSkge1xyXG4gICAgICBjb25zb2xlLmxvZyhyZXNwb25zZSk7XHJcbiAgICAgICRzY29wZS5jdXJyZW50VXNlciA9IHJlc3BvbnNlO1xyXG4gICAgfSk7XHJcbiAgfVxyXG59KTtcclxuIiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXHJcbi5jb250cm9sbGVyKCdMb2dpbkN0cmwnLCBmdW5jdGlvbiAoJHNjb3BlLCBVc2VyU3ZjKSB7XHJcbiAgJHNjb3BlLmxvZ2luID0gZnVuY3Rpb24gKHVzZXJuYW1lLCBwYXNzd29yZCwgcmVtZW1iZXJNZSkge1xyXG4gICAgY29uc29sZS5sb2cocmVtZW1iZXJNZSk7XHJcbiAgICBVc2VyU3ZjLmxvZ2luKHVzZXJuYW1lLCBwYXNzd29yZCwgcmVtZW1iZXJNZSlcclxuICAgICAgLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XHJcbiAgICAgICAgJHNjb3BlLiRlbWl0KCdsb2dpbicsIHJlc3BvbnNlLmRhdGEpO1xyXG4gICAgICB9KTtcclxuICB9O1xyXG59KTtcclxuIiwiYXBwLmNvbnRyb2xsZXIoJ1Bvc3RzQ3RybCcsIGZ1bmN0aW9uICgkc2NvcGUsIFBvc3RzU3ZjKSB7XHJcbiAgJHNjb3BlLmFkZFBvc3QgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICBpZiAoJHNjb3BlLnBvc3RCb2R5KSB7XHJcbiAgICAgIFBvc3RzU3ZjLmNyZWF0ZSh7XHJcbiAgICAgICAgYm9keTogJHNjb3BlLnBvc3RCb2R5XHJcbiAgICAgIH0pXHJcbiAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uIChwb3N0KSB7XHJcbiAgICAgICAgJHNjb3BlLnBvc3RzLnVuc2hpZnQocG9zdCk7XHJcbiAgICAgICAgJHNjb3BlLnBvc3RCb2R5ID0gbnVsbDtcclxuICAgICAgfSk7XHJcbiAgICB9XHJcbiAgfTtcclxuICBQb3N0c1N2Yy5mZXRjaCgpLnN1Y2Nlc3MoZnVuY3Rpb24gKHBvc3RzKSB7XHJcbiAgICAkc2NvcGUucG9zdHMgPSBwb3N0cztcclxuICB9KTtcclxufSk7XHJcbiIsImFwcC5zZXJ2aWNlKCdQb3N0c1N2YycsIGZ1bmN0aW9uICgkaHR0cCkge1xyXG4gIHRoaXMuZmV0Y2ggPSBmdW5jdGlvbiAoKSB7XHJcbiAgICByZXR1cm4gJGh0dHAuZ2V0KCcvYXBpL3Bvc3RzJyk7XHJcbiAgfTtcclxuICB0aGlzLmNyZWF0ZSA9IGZ1bmN0aW9uIChwb3N0KSB7XHJcbiAgICByZXR1cm4gJGh0dHAucG9zdCgnL2FwaS9wb3N0cycsIHBvc3QpO1xyXG4gIH07XHJcbn0pO1xyXG4iLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcclxuLmNvbnRyb2xsZXIoJ1JlZ2lzdGVyQ3RybCcsIGZ1bmN0aW9uICgkc2NvcGUsIFVzZXJTdmMpIHtcclxuICAkc2NvcGUucmVnaXN0ZXIgPSBmdW5jdGlvbiAodXNlcm5hbWUsIHBhc3N3b3JkKSB7XHJcbiAgICBVc2VyU3ZjLmNyZWF0ZVVzZXIodXNlcm5hbWUsIHBhc3N3b3JkKVxyXG4gICAgICAudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHtcclxuICAgICAgICBpZiAocmVzcG9uc2Uuc3RhdHVzID09PSAyMDEpIHtcclxuICAgICAgICAgIC8vIFVzZXJTdmMubG9naW4odXNlcm5hbWUsIHBhc3N3b3JkKVxyXG4gICAgICAgICAgLy8gLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XHJcbiAgICAgICAgICAvLyAgICRzY29wZS4kZW1pdCgnbG9naW4nLCByZXNwb25zZS5kYXRhKTtcclxuICAgICAgICAgIC8vIH0pO1xyXG4gICAgICAgICAgY29uc29sZS5sb2coJ3JlZ2lzdHJhdGlvbiBzdWNjZXNzZnVsJyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgY29uc29sZS5sb2coJ3JlZ2lzdHJhdGlvbiB1bnN1Y2Nlc3NmdWwnKTtcclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG4gIH07XHJcbn0pO1xyXG4iLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcclxuLmNvbmZpZyhmdW5jdGlvbiAoJHJvdXRlUHJvdmlkZXIsICRsb2NhdGlvblByb3ZpZGVyKSB7XHJcbiAgJGxvY2F0aW9uUHJvdmlkZXIuaHRtbDVNb2RlKHRydWUpO1xyXG4gICRyb3V0ZVByb3ZpZGVyXHJcbiAgICAud2hlbignLycsIHsgY29udHJvbGxlcjogJ1Bvc3RzQ3RybCcsIHRlbXBsYXRlVXJsOiAncG9zdHMuaHRtbCd9KVxyXG4gICAgLndoZW4oJy9yZWdpc3RlcicsIHsgY29udHJvbGxlcjogJ1JlZ2lzdGVyQ3RybCcsIHRlbXBsYXRlVXJsOiAncmVnaXN0ZXIuaHRtbCd9KVxyXG4gICAgLndoZW4oJy9sb2dpbicsIHsgY29udHJvbGxlcjogJ0xvZ2luQ3RybCcsIHRlbXBsYXRlVXJsOiAnbG9naW4uaHRtbCd9KTtcclxufSk7XHJcbiIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxyXG4uc2VydmljZSgnVXNlclN2YycsIGZ1bmN0aW9uICgkaHR0cCkge1xyXG4gIHZhciBzdmMgPSB0aGlzO1xyXG5cclxuICBzdmMuZ2V0VXNlciA9IGZ1bmN0aW9uICgpIHtcclxuICAgIHJldHVybiAkaHR0cC5nZXQoJy9hcGkvdXNlcnMnKTtcclxuICB9O1xyXG4gIHN2Yy5sb2dpbiA9IGZ1bmN0aW9uICh1c2VybmFtZSwgcGFzc3dvcmQsIHJlbWVtYmVyTWUpIHtcclxuICAgIHJldHVybiAkaHR0cC5wb3N0KCcvYXBpL3Nlc3Npb25zJywge1xyXG4gICAgICB1c2VybmFtZTogdXNlcm5hbWUsXHJcbiAgICAgIHBhc3N3b3JkOiBwYXNzd29yZFxyXG4gICAgfSlcclxuICAgIC50aGVuKGZ1bmN0aW9uICh2YWwpIHtcclxuICAgICAgaWYgKHJlbWVtYmVyTWUpIHtcclxuICAgICAgICBjb25zb2xlLmxvZygncmVtZW1iZXJNZSAtIHVzZXJTdmMnKTtcclxuICAgICAgICB3aW5kb3cubG9jYWxTdG9yYWdlLnRva2VuID0gdmFsLmRhdGE7XHJcbiAgICAgICAgY29uc29sZS5sb2coJ3Rva2VuIGZyb20gbG9jYWxTdG9yYWdlOiAnICsgd2luZG93LmxvY2FsU3RvcmFnZS50b2tlbik7XHJcbiAgICAgIH1cclxuICAgICAgLy8gc3ZjLnRva2VuID0gdmFsLmRhdGE7XHJcbiAgICAgICRodHRwLmRlZmF1bHRzLmhlYWRlcnMuY29tbW9uWydYLWF1dGgnXSA9IHZhbC5kYXRhO1xyXG4gICAgICByZXR1cm4gc3ZjLmdldFVzZXIoKTtcclxuICAgIH0pO1xyXG4gIH07XHJcbiAgc3ZjLmxvZ291dCA9IGZ1bmN0aW9uICgpIHtcclxuICAgIGRlbGV0ZSAkaHR0cC5kZWZhdWx0cy5oZWFkZXJzLmNvbW1vblsnWC1hdXRoJ107XHJcbiAgfTtcclxuICBzdmMuY3JlYXRlVXNlciA9IGZ1bmN0aW9uICh1c2VybmFtZSwgcGFzc3dvcmQpIHtcclxuICAgIHJldHVybiAkaHR0cC5wb3N0KCcvYXBpL3VzZXJzJywge1xyXG4gICAgICB1c2VybmFtZTogdXNlcm5hbWUsXHJcbiAgICAgIHBhc3N3b3JkOiBwYXNzd29yZFxyXG4gICAgfSk7XHJcbiAgfTtcclxufSk7XHJcbiJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
